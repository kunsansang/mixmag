jsoneopack([96],{517:function(e,o,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var s=t(9),l=n(s),u=t(421),r=n(u);$(function(){function e(e,t,n,s){o.append('<p><span style="color:'+n+'">'+e+"</span> @ "+ +(s.getHours()<10?"0"+s.getHours():s.getHours())+":"+(s.getMinutes()<10?"0"+s.getMinutes():s.getMinutes())+": "+t+"</p>")}var o=$("#content"),t=$("#input"),n=$("#status"),s=!1,u=null,i=!1,a=r.default,c={url:"/websocket/chat/test",contentType:"application/json",logLevel:"debug",transport:"websocket",fallbackTransport:"long-polling"},d=null,p=void 0,g=void 0;c.onOpen=function(e){null!==d&&(clearInterval(d),d=null),o.html($("<p>",{text:"Atmosphere connected using "+e.transport})),t.removeAttr("disabled").focus(),n.text("Choose name:"),console.log("oh connected = "+(0,l.default)(e))},c.onMessage=function(o){var r=o.responseBody,c=void 0;try{c=$.parseJSON(r)}catch(e){return void console.log("This doesn't look like a valid JSON: ",r.data)}if(!0===c.ready&&null===c.uuid)return console.log("認証に失敗したのでとじー"),void a.unsubscribe();if(!0===c.ready&&null!==c.uuid)return g=c.uuid,void console.log("認証ok");if(console.log("jjjj = "+(0,l.default)(c)),t.removeAttr("disabled").focus(),i){var d=c.nickname===u,p="string"==typeof c.time?parseInt(c.time):c.time;e(c.nickname,c.message,d?"blue":"black",new Date(p))}else i=!0,n.text(s+": ").css("color","blue")},c.onClose=function(e){console.log("close"),i=!1},c.onError=function(e){o.html($("<p>",{text:"Sorry, but there's some problem with your socket or the server is down"})),null===d&&(d=setInterval(function(){a.unsubscribe(c),p=a.subscribe(c)},5e3))},console.log($.atmosphere),console.log(a),p=a.subscribe(c),t.keydown(function(e){if(13===e.keyCode){var o=$(this).val();null===u&&(u=o),p.push($.stringifyJSON({nickname:u,message:o,uuid:g})),$(this).val(""),t.attr("disabled","disabled"),!1===s&&(s=o)}})})}},[517]);